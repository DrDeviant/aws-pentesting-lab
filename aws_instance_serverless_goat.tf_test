# resource "aws_serverlessapplicationrepository_cloudformation_stack" "serverless-goat" {
#   name             = "serverless-goat"
#   application_id   = "arn:aws:serverlessrepo:us-east-1:761130837472:applications/serverless-goat"
#   capabilities     = ["CAPABILITY_IAM"]
#   # Uncomment the next line to deploy a specific version
#   # semantic_version = "3.4.2"

#   parameters = {
#     # All of these parameters are optional and are only shown here for demonstration purposes
#     # See https://github.com/alexcasalboni/aws-lambda-power-tuning/blob/master/README-INPUT-OUTPUT.md#state-machine-input-at-deployment-time
#     # PowerValues           = "128,192,256,512,1024,2048,3072,4096,5120,6144,7168,8192,9216,10240"
#     # lambdaResource        = "*"
#     # totalExecutionTimeout = 900
#     # visualizationURL      = "https://lambda-power-tuning.show/"
#   }
# }

# AWS-Vulnerable-Lambda: https://github.com/MscDevOpsSecurity/Serverless-Goat

# Get AWS-Vulnerable-Lambda from GitHub
module "AWS-Serveless-Goat" {
  source = "github.com/MscDevOpsSecurity/Serverless-Goat"
}



# Define a local variable for the Lambda function
locals {
  servelessgoat_src_path = "${path.module}/.terraform/modules/AWS-Serveless-Goat"
}

resource "aws_cloudformation_stack" "serverless-goat" {
  name             = "serverless-goat"
  capabilities     = ["CAPABILITY_AUTO_EXPAND"]
  #parameters = {
  #  VpcId = var.vpc_id
  #}
  template_body = file("${local.servelessgoat_src_path}/template.yaml")
}

      

